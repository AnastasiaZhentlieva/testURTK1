using System;

class Calculator
{
    static void Main(string[] args)
    {
        Console.WriteLine("КАЛЬКУЛЯТОР");
        
        while (true)
        {
            try
            {
                Console.WriteLine("\nВыберите операцию:");
                Console.WriteLine("1. Сложение (+)");
                Console.WriteLine("2. Вычитание (-)");
                Console.WriteLine("3. Умножение (*)");
                Console.WriteLine("4. Деление (/)");
                Console.WriteLine("5. Выход");
                Console.Write("Ваш выбор: ");

                string choice = Console.ReadLine();

                if (choice == "5" || choice.ToLower() == "выход")
                    break;

                if (int.TryParse(choice, out int operation) && operation >= 1 && operation <= 4)
                {
                    Console.Write("Введите первое число: ");
                    double num1 = GetNumber();
                    
                    Console.Write("Введите второе число: ");
                    double num2 = GetNumber();

                    double result = Calculate(operation, num1, num2);
                    Console.WriteLine($"Результат: {result}");
                }
                else
                {
                    Console.WriteLine("Неверный выбор операции!");
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Ошибка: {ex.Message}");
            }
        }
    }

    static double GetNumber()
    {
        while (true)
        {
            string input = Console.ReadLine();
            if (double.TryParse(input, out double number))
                return number;
            else
                Console.Write("Неверный формат числа. Попробуйте снова: ");
        }
    }

    static double Calculate(int operation, double num1, double num2)
    {
        return operation switch
        {
            1 => num1 + num2,
            2 => num1 - num2,
            3 => num1 * num2,
            4 => num2 != 0 ? num1 / num2 : throw new DivideByZeroException("Деление на ноль!"),
            _ => throw new ArgumentException("Неизвестная операция")
        };
    }
}
